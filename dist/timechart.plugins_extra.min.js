this.TimeChart=this.TimeChart||{},this.TimeChart.plugins_extra=function(t,e){"use strict";const s={mouseButtons:1,enableX:!0,enableY:!0,cancelOnSecondPointer:!1};class i{constructor(t,e){this.chart=t,this.options=e,this.start=null;const s=t.contentBoxDetector.node;s.tabIndex=-1,s.addEventListener("pointerdown",(t=>this.onMouseDown(t)),{signal:t.model.abortController.signal}),s.addEventListener("pointerup",(t=>this.onMouseUp(t)),{signal:t.model.abortController.signal}),s.addEventListener("pointermove",(t=>this.onMouseMove(t)),{signal:t.model.abortController.signal}),s.addEventListener("pointercancel",(t=>this.onPointerCancel(t)),{signal:t.model.abortController.signal}),s.addEventListener("keydown",(t=>this.onKeyDown(t)),{signal:t.model.abortController.signal});const i=document.createElementNS("http://www.w3.org/2000/svg","style");i.textContent="\n.timechart-selection {\n    stroke: currentColor;\n    stroke-width: 1;\n    fill: gray;\n    opacity: 0.5;\n    visibility: hidden;\n}",t.svgLayer.svgNode.appendChild(i),this.visual=document.createElementNS("http://www.w3.org/2000/svg","rect"),this.visual.classList.add("timechart-selection"),t.svgLayer.svgNode.appendChild(this.visual)}onKeyDown(t){"Escape"===t.code&&this.reset()}reset(){if(null===this.start)return;this.chart.contentBoxDetector.node.releasePointerCapture(this.start.id),this.visual.style.visibility="hidden",this.start=null}getPoint(t){const e=this.chart.svgLayer.svgNode.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}onMouseDown(t){if(null!==this.start)return void(this.options.cancelOnSecondPointer&&this.reset());if("mouse"===t.pointerType&&0==(t.buttons&this.options.mouseButtons))return;const e=this.chart.contentBoxDetector.node;this.start={p:this.getPoint(t),id:t.pointerId},e.setPointerCapture(t.pointerId),this.visual.x.baseVal.value=this.start.p.x,this.visual.y.baseVal.value=this.start.p.y,this.visual.width.baseVal.value=0,this.visual.height.baseVal.value=0,this.visual.style.visibility="visible"}onMouseMove(t){var e;if(t.pointerId!==(null===(e=this.start)||void 0===e?void 0:e.id))return;const s=this.getPoint(t);if(this.options.enableX){const t=Math.min(this.start.p.x,s.x),e=Math.abs(this.start.p.x-s.x);this.visual.x.baseVal.value=t,this.visual.width.baseVal.value=e}else this.visual.setAttribute("x","0"),this.visual.setAttribute("width","100%");if(this.options.enableY){const t=Math.min(this.start.p.y,s.y),e=Math.abs(this.start.p.y-s.y);this.visual.y.baseVal.value=t,this.visual.height.baseVal.value=e}else this.visual.setAttribute("y","0"),this.visual.setAttribute("height","100%")}onMouseUp(t){var e;if(t.pointerId!==(null===(e=this.start)||void 0===e?void 0:e.id))return;const s=this.getPoint(t);let i=!1;if(this.options.enableX){const t=Math.min(this.start.p.x,s.x),e=Math.max(this.start.p.x,s.x);if(e-t>0){const s=[this.chart.model.xScale.invert(t),this.chart.model.xScale.invert(e)];this.chart.model.xScale.domain(s),this.chart.options.xRange=null,i=!0}}if(this.options.enableY){const t=Math.max(this.start.p.y,s.y),e=Math.min(this.start.p.y,s.y);if(t-e>0){const s=[this.chart.model.yScale.invert(t),this.chart.model.yScale.invert(e)];this.chart.model.yScale.domain(s),this.chart.options.yRange=null,i=!0}}i&&this.chart.model.requestRedraw(),this.reset()}onPointerCancel(t){var e;t.pointerId===(null===(e=this.start)||void 0===e?void 0:e.id)&&this.reset()}}return t.EventsPlugin=class{constructor(t){this.data=null!=t?t:[]}apply(t){const s=e.select(t.svgLayer.svgNode).append("svg");return s.append("style").text("\n.timechart-event-line {\n    stroke: currentColor;\n    stroke-width: 1;\n    stroke-dasharray: 2 1;\n    opacity: 0.7;\n}"),t.model.resized.on(((e,i)=>{s.attr("height",i-t.options.paddingBottom)})),t.model.updated.on((()=>{const e=s.selectAll("g").data(this.data);e.exit().remove();const i=e.enter().append("g");i.append("line").attr("y2","100%").attr("class","timechart-event-line"),i.append("text").attr("x",5).attr("y",t.options.paddingTop).attr("dy","0.8em");const n=e.merge(i);n.attr("transform",(e=>`translate(${t.model.xScale(e.x)}, 0)`)),n.select("text").text((t=>t.name))})),this}},t.SelectZoomPlugin=class{constructor(t){t||(t={}),s.isPrototypeOf(t)||Object.setPrototypeOf(t,s),this.options=t}apply(t){return new i(t,this.options)}},t}({},d3);
//# sourceMappingURL=timechart.plugins_extra.min.js.map
